<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Minecraft Mini Miner (HTML)</title>
  <style>
    :root{
      --bg:#0b1020; --panel:#11162a; --panel2:#0e1430; --text:#e9f1ff; --accent:#6ee7ff; --ok:#6cff9a; --warn:#ffd166;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
         background: radial-gradient(60% 80% at 50% 0%, #1b2550 0,#0b1020 55%);
         color:var(--text); min-height:100vh; display:flex; flex-direction:column}
    header{display:flex;align-items:center;gap:.75rem;padding:1rem 1.25rem;background:linear-gradient(180deg,#101735,#0d1330)}
    header h1{font-size:1.1rem;margin:0;letter-spacing:.3px}
    header .badge{font-size:.75rem;opacity:.85;padding:.25rem .5rem;border-radius:.5rem;background:#203070}
    main{display:grid;grid-template-columns:320px 1fr; gap:12px; padding:12px; width:100%; max-width:1200px; margin-inline:auto; flex:1}
    #left{background:var(--panel);border:1px solid #262f55;border-radius:14px; padding:12px; display:flex; flex-direction:column; gap:10px}
    #right{background:var(--panel2);border:1px solid #1e2548;border-radius:14px; padding:10px; display:flex; flex-direction:column; gap:10px}
    .row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    .stat{background:#141c3f;border:1px solid #2c3b70; padding:.4rem .6rem; border-radius:10px; font-size:.9rem}
    #canvasWrap{position:relative; aspect-ratio: 16/9; width:100%; background:#090f24; border:1px solid #27336b; border-radius:12px; overflow:hidden}
    canvas{width:100%;height:100%; display:block; image-rendering: pixelated}
    button{cursor:pointer; border:1px solid #2b3569; background:#152254; color:var(--text); padding:.55rem .8rem; border-radius:10px; font-weight:600}
    button:hover{filter:brightness(1.1)}
    button:disabled{opacity:.5; cursor:not-allowed}
    .inv{display:grid;grid-template-columns:repeat(4,1fr); gap:8px}
    .cell{background:#121a3a;border:1px solid #2b3569; border-radius:10px; padding:8px; display:flex; align-items:center; justify-content:space-between; gap:8px}
    .cell b{font-size:1rem}
    .bar{height:10px;background:#0e1330;border:1px solid #2a3770;border-radius:8px; overflow:hidden}
    .fill{height:100%;background:linear-gradient(90deg,#34e39c,#61e9ff)}
    .tip{font-size:.9rem;opacity:.85}
    .footer{padding:10px; text-align:center; opacity:.85}
    .recipe{display:flex; gap:10px; align-items:center; justify-content:space-between; border:1px dashed #334080; padding:8px; border-radius:10px}
    .grid3x3{display:grid; grid-template-columns:repeat(3,18px); gap:2px}
    .sq{width:18px;height:18px;background:#0d1434;border:1px solid #23316b}
    .sq.dirt{background:#6b4f2a}
    .sq.wood{background:#9b6f34}
    .sq.stone{background:#7f8a99}
    .sq.iron{background:#c7c7c7}
    .sq.gold{background:#e6c33a}
    .sq.diamond{background:#38e1ff}
    .pulse{animation:pulse 1s ease both}
    @keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.06)}100%{transform:scale(1)}}
  </style>
</head>
<body>
  <header>
    <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M3 12l4-2 5 2 5-3 4 2v6l-4-2-5 3-5-2-4 2v-6z" fill="#6ee7ff"/>
    </svg>
    <h1>Minecraft Mini Miner</h1>
    <span class="badge">HTML ‚Ä¢ Canvas ‚Ä¢ No assets</span>
  </header>

  <main>
    <section id="left">
      <div class="row">
        <div class="stat" id="pick">‚õèÔ∏è Cu·ªëc: <b data-pick>G·ªó</b></div>
        <div class="stat">‚ö° T·ªëc ƒë·ªô ƒë√†o: <b data-dps>1</b> /s</div>
        <div class="stat">üíé ƒêi·ªÉm: <b data-score>0</b></div>
      </div>

      <div class="bar" title="ƒê·ªô b·ªÅn kh·ªëi"><div class="fill" style="width:100%" data-hpbar></div></div>
      <div class="tip">B·∫•m ho·∫∑c gi·ªØ chu·ªôt v√†o kh·ªëi ƒë·ªÉ ƒë√†o. Thu th·∫≠p t√†i nguy√™n v√† n√¢ng c·∫•p cu·ªëc!</div>

      <div class="inv" id="inv"></div>

      <div>
        <h3 style="margin:.5rem 0 .25rem">Ch·∫ø t·∫°o</h3>
        <div class="recipe">
          <div>
            <div><b>Cu·ªëc ƒê√°</b> (tƒÉng t·ªëc ƒë·ªô ƒë√†o)</div>
            <small>C·∫ßn: 3 Stone + 2 Wood</small>
          </div>
          <div class="grid3x3" aria-hidden="true">
            <span class="sq stone"></span><span class="sq stone"></span><span class="sq stone"></span>
            <span class="sq"></span><span class="sq wood"></span><span class="sq"></span>
            <span class="sq"></span><span class="sq wood"></span><span class="sq"></span>
          </div>
          <button id="craftStone">Ch·∫ø t·∫°o</button>
        </div>
        <div class="recipe">
          <div>
            <div><b>Cu·ªëc S·∫Øt</b></div>
            <small>C·∫ßn: 3 Iron + 2 Wood</small>
          </div>
          <div class="grid3x3">
            <span class="sq iron"></span><span class="sq iron"></span><span class="sq iron"></span>
            <span class="sq"></span><span class="sq wood"></span><span class="sq"></span>
            <span class="sq"></span><span class="sq wood"></span><span class="sq"></span>
          </div>
          <button id="craftIron">Ch·∫ø t·∫°o</button>
        </div>
        <div class="recipe">
          <div>
            <div><b>Cu·ªëc Kim C∆∞∆°ng</b></div>
            <small>C·∫ßn: 3 Diamond + 2 Wood</small>
          </div>
          <div class="grid3x3">
            <span class="sq diamond"></span><span class="sq diamond"></span><span class="sq diamond"></span>
            <span class="sq"></span><span class="sq wood"></span><span class="sq"></span>
            <span class="sq"></span><span class="sq wood"></span><span class="sq"></span>
          </div>
          <button id="craftDia">Ch·∫ø t·∫°o</button>
        </div>
        <div class="recipe">
          <div>
            <div><b>Cu·ªëc V√†ng</b> (ƒë√†o nhanh nh∆∞ng bonus √≠t)</div>
            <small>C·∫ßn: 3 Gold + 2 Wood</small>
          </div>
          <div class="grid3x3">
            <span class="sq gold"></span><span class="sq gold"></span><span class="sq gold"></span>
            <span class="sq"></span><span class="sq wood"></span><span class="sq"></span>
            <span class="sq"></span><span class="sq wood"></span>
            <span class="sq"></span>
          </div>
          <button id="craftGold">Ch·∫ø t·∫°o</button>
        </div>
      </div>

      <div class="footer">Tip: Gi·ªØ chu·ªôt ƒë·ªÉ ƒë√†o li√™n t·ª•c ‚Ä¢ Nh·∫•n <kbd>R</kbd> ƒë·ªÉ l√†m m·ªõi th·∫ø gi·ªõi</div>
    </section>

    <section id="right">
      <div class="row" style="justify-content:space-between;align-items:center">
        <div class="row">
          <button id="regen">T·∫°o th·∫ø gi·ªõi m·ªõi</button>
          <button id="music">B·∫≠t nh·∫°c ‚ô™</button>
        </div>
        <div class="stat">T·∫ßng: <b data-depth>Y=0</b></div>
      </div>
      <div id="canvasWrap"><canvas id="c" width="960" height="540"></canvas></div>
      <div style="opacity:.85">M·ªói kh·ªëi c√≥ ƒë·ªô b·ªÅn kh√°c nhau. Xu·ªëng s√¢u h∆°n s·∫Ω c√≥ nhi·ªÅu qu·∫∑ng hi·∫øm.</div>
    </section>
  </main>

  <script>
    // --- Minimal pixel-art mining game (no external assets) ---
    const canvas = document.getElementById('c');
    const ctx = canvas.getContext('2d');
    const W = canvas.width, H = canvas.height;
    const COLS = 16, ROWS = 9, TILE = Math.floor(W / COLS);

    const invEl = document.getElementById('inv');
    const hpBar = document.querySelector('[data-hpbar]');
    const scoreEl = document.querySelector('[data-score]');
    const dpsEl = document.querySelector('[data-dps]');
    const depthEl = document.querySelector('[data-depth]');

    const pickNameEl = document.querySelector('[data-pick]');

    const TYPES = {
      air   : { id:0, name:'Air',     hp:0,  color:'#000000' },
      grass : { id:1, name:'C·ªè',      hp:10, color:'#4CAF50', drop:'dirt', bonus:0 },
      dirt  : { id:2, name:'ƒê·∫•t',     hp:10, color:'#6b4f2a', drop:'dirt', bonus:0 },
      wood  : { id:3, name:'G·ªó',      hp:16, color:'#9b6f34', drop:'wood', bonus:0 },
      stone : { id:4, name:'ƒê√°',      hp:26, color:'#7f8a99', drop:'stone', bonus:1 },
      coal  : { id:5, name:'Than',    hp:22, color:'#333333', drop:'coal', bonus:2 },
      iron  : { id:6, name:'S·∫Øt',     hp:34, color:'#c7c7c7', drop:'iron', bonus:3 },
      gold  : { id:7, name:'V√†ng',    hp:30, color:'#e6c33a', drop:'gold', bonus:2 },
      diamond:{id:8, name:'Kim c∆∞∆°ng',hp:48, color:'#38e1ff', drop:'diamond', bonus:5 },
      bedrock:{id:9, name:'Bedrock',  hp:1e9, color:'#1a1a1a', drop:null, bonus:0 }
    };
    const ORDER = ['dirt','wood','stone','coal','iron','gold','diamond'];

    const world = [];
    const inv = { dirt:0, wood:0, stone:0, coal:0, iron:0, gold:0, diamond:0 };

    const picks = {
      wood:{ speed:1,   bonus:0,  label:'G·ªó' },
      stone:{speed:2,   bonus:1,  label:'ƒê√°' },
      iron:{ speed:3.5, bonus:2,  label:'S·∫Øt' },
      gold:{ speed:5,   bonus:0,  label:'V√†ng (nhanh, √≠t th∆∞·ªüng)' },
      diamond:{speed:6, bonus:4,  label:'Kim c∆∞∆°ng' }
    };
    let pick = 'wood';

    let target = {x:0,y:0,hp:10,type:TYPES.dirt};
    let holding = false; let score = 0; let depth = 0;

    function rand(a,b){return Math.floor(Math.random()*(b-a+1))+a}

    function genWorld(seedDepth=0){
      depth = seedDepth;
      world.length = 0;
      for(let r=0;r<ROWS;r++){
        const row=[]; const globalY = depth + r;
        for(let c=0;c<COLS;c++){
          let t = TYPES.dirt;
          if(globalY===0){
            t = (c%7===0)?TYPES.wood : TYPES.grass;
          } else if(globalY<3){
            t = (Math.random()<.1)?TYPES.coal:TYPES.stone;
          } else if(globalY<6){
            t = (Math.random()<.12)?TYPES.iron:TYPES.stone;
          } else if(globalY<10){
            const roll=Math.random();
            t = roll<.10?TYPES.gold : (roll<.24?TYPES.iron:TYPES.stone);
          } else if(globalY<14){
            const roll=Math.random();
            t = roll<.08?TYPES.diamond : (roll<.22?TYPES.gold:TYPES.stone);
          } else if(globalY===14){
            t=TYPES.bedrock;
          } else {
            t=TYPES.stone;
          }
          row.push({type:t,hp:t.hp});
        }
        world.push(row);
      }
      setTarget(0,0);
      updateInvUI();
      updateStats();
      draw();
    }

    function colorShade(hex, amt){
      let col = hex.replace('#','');
      const num = parseInt(col,16);
      let r = Math.min(255, Math.max(0, (num>>16)+amt));
      let g = Math.min(255, Math.max(0, ((num>>8)&0xff)+amt));
      let b = Math.min(255, Math.max(0, (num&0xff)+amt));
      return '#'+(r<<16|g<<8|b).toString(16).padStart(6,'0');
    }

    function draw(){
      ctx.clearRect(0,0,W,H);
      // parallax starry backdrop
      ctx.fillStyle = '#08102a'; ctx.fillRect(0,0,W,H);
      for(let i=0;i<60;i++){
        ctx.fillStyle='rgba(255,255,255,'+(0.2+Math.random()*0.6)+')';
        ctx.fillRect(rand(0,W), rand(0,40), 1, 1);
      }
      for(let r=0;r<ROWS;r++){
        for(let c=0;c<COLS;c++){
          const x=c*TILE, y=r*TILE;
          const cell=world[r][c];
          const base = cell.type.color;
          // tile body
          ctx.fillStyle = base;
          ctx.fillRect(x+1,y+1,TILE-2,TILE-2);
          // simple bevel
          ctx.fillStyle=colorShade(base,25);
          ctx.fillRect(x+1,y+1,TILE-2,3);
          ctx.fillRect(x+1,y+1,3,TILE-2);
          ctx.fillStyle=colorShade(base,-35);
          ctx.fillRect(x+1,y+TILE-4,TILE-2,3);
          ctx.fillRect(x+TILE-4,y+1,3,TILE-2);

          // ores sparkles
          if(cell.type===TYPES.diamond || cell.type===TYPES.gold){
            ctx.fillStyle = cell.type===TYPES.diamond ? '#bff7ff' : '#fff0a8';
            for(let k=0;k<3;k++) ctx.fillRect(x+rand(5,TILE-6), y+rand(5,TILE-6), 2,2);
          }

          // target highlight
          if(target.x===c && target.y===r){
            ctx.strokeStyle = '#6ee7ff'; ctx.lineWidth=2;
            ctx.strokeRect(x+1.5,y+1.5,TILE-3,TILE-3);
          }
        }
      }
      // UI label for selected block
      ctx.fillStyle='rgba(0,0,0,.45)';
      ctx.fillRect(8,8,240,28);
      ctx.fillStyle='#e9f1ff';
      ctx.font='16px ui-sans-serif,system-ui';
      ctx.fillText('Kh·ªëi: '+target.type.name+'  (HP '+Math.max(0,Math.ceil(target.hp))+')', 14, 28);
    }

    function setTarget(col,row){
      const c = Math.max(0,Math.min(COLS-1,col));
      const r = Math.max(0,Math.min(ROWS-1,row));
      target.x=c; target.y=r; target.type = world[r][c].type; target.hp = world[r][c].hp;
      updateHpBar(); draw();
    }

    function updateHpBar(){
      const pct = Math.max(0, Math.min(1, target.hp / target.type.hp));
      hpBar.style.width = (pct*100).toFixed(1)+'%';
    }

    function updateStats(){
      dpsEl.textContent = picks[pick].speed.toFixed(2).replace(/\.00$/,'');
      pickNameEl.textContent = picks[pick].label;
      scoreEl.textContent = score;
      depthEl.textContent = 'Y=' + depth;
    }

    function updateInvUI(){
      invEl.innerHTML = '';
      ORDER.forEach(key=>{
        const el = document.createElement('div'); el.className='cell';
        el.innerHTML = `<span>${iconFor(key)} <b>${labelFor(key)}</b></span><span>x ${inv[key]}</span>`;
        invEl.appendChild(el);
      });
    }
    function labelFor(key){
      return {
        dirt:'ƒê·∫•t', wood:'G·ªó', stone:'ƒê√°', coal:'Than', iron:'S·∫Øt', gold:'V√†ng', diamond:'Kim c∆∞∆°ng'
      }[key]||key;
    }
    function iconFor(key){
      const colors={dirt:'#6b4f2a',wood:'#9b6f34',stone:'#7f8a99',coal:'#333',iron:'#c7c7c7',gold:'#e6c33a',diamond:'#38e1ff'};
      const c=colors[key]||'#888';
      return `<span style="display:inline-block;width:14px;height:14px;background:${c};vertical-align:middle;border:1px solid #21306b"></span>`
    }

    // Mining loop
    let last=0; function loop(t){
      const dt = (t-last)/1000; last=t;
      if(holding){
        const speed = picks[pick].speed;
        target.hp -= speed * (1 + Math.random()*0.2);
        if(target.hp<=0){
          mineBlock(target.x,target.y);
        }
        updateHpBar(); draw();
      }
      requestAnimationFrame(loop);
    }

    function mineBlock(x,y){
      const cell = world[y][x];
      if(!cell || cell.type===TYPES.air || cell.type===TYPES.bedrock) return;
      const drop = cell.type.drop;
      if(drop){
        const base = 1; const bonus = picks[pick].bonus + (cell.type.bonus||0);
        const qty = base + (Math.random()<0.25?1:0) + Math.floor(bonus/3);
        inv[drop]+=qty; score += qty;
        flashUI(); updateInvUI(); updateStats();
      }
      // replace with air and lower surrounding HP slightly for chain-feel
      world[y][x] = {type:TYPES.air,hp:0};
      for(let dy=-1;dy<=1;dy++) for(let dx=-1;dx<=1;dx++){
        const ny=y+dy,nx=x+dx; if(world[ny]&&world[ny][nx]&&world[ny][nx].type.hp<1e8){
          world[ny][nx].hp = Math.max(4, world[ny][nx].hp - 2);
        }
      }
      // if top row cleared a lot, scroll world (go deeper)
      const clearedTop = world[0].every(c=>c.type===TYPES.air);
      if(clearedTop){
        depth++; world.shift();
        // push new bottom row based on depth
        const globalY = depth + ROWS - 1;
        const row=[];
        for(let c=0;c<COLS;c++){
          let t=TYPES.stone; const roll=Math.random();
          if(globalY<4) t = roll<.1?TYPES.coal:TYPES.stone;
          else if(globalY<7) t = roll<.14?TYPES.iron:TYPES.stone;
          else if(globalY<12) t = roll<.12?TYPES.gold:(roll<.26?TYPES.iron:TYPES.stone);
          else t = roll<.09?TYPES.diamond:(roll<.22?TYPES.gold:TYPES.stone);
          row.push({type:t,hp:t.hp});
        }
        world.push(row);
        depthEl.parentElement.classList.add('pulse'); setTimeout(()=>depthEl.parentElement.classList.remove('pulse'),450);
      }
      setTarget(Math.min(COLS-1, x+1), y);
    }

    function flashUI(){
      document.getElementById('left').classList.add('pulse');
      setTimeout(()=>document.getElementById('left').classList.remove('pulse'),350);
    }

    // Input handling
    canvas.addEventListener('mousedown', e=>{holding=true; updateHpBar()});
    window.addEventListener('mouseup', ()=> holding=false);
    canvas.addEventListener('mousemove', e=>{
      const rect = canvas.getBoundingClientRect();
      const x = Math.floor((e.clientX-rect.left)/rect.width*COLS);
      const y = Math.floor((e.clientY-rect.top)/rect.height*ROWS);
      setTarget(x,y);
    });

    // Crafting
    function canSpend(cost){ for(const k in cost){ if(inv[k]<(cost[k]||0)) return false;} return true;}
    function spend(cost){ for(const k in cost){ inv[k]-=cost[k]; } updateInvUI(); }

    document.getElementById('craftStone').onclick=()=>{
      const cost={stone:3, wood:2}; if(!canSpend(cost)) return alert('Thi·∫øu v·∫≠t li·ªáu!');
      spend(cost); pick='stone'; updateStats();
    }
    document.getElementById('craftIron').onclick=()=>{
      const cost={iron:3, wood:2}; if(!canSpend(cost)) return alert('Thi·∫øu v·∫≠t li·ªáu!');
      spend(cost); pick='iron'; updateStats();
    }
    document.getElementById('craftDia').onclick=()=>{
      const cost={diamond:3, wood:2}; if(!canSpend(cost)) return alert('Thi·∫øu v·∫≠t li·ªáu!');
      spend(cost); pick='diamond'; updateStats();
    }
    document.getElementById('craftGold').onclick=()=>{
      const cost={gold:3, wood:2}; if(!canSpend(cost)) return alert('Thi·∫øu v·∫≠t li·ªáu!');
      spend(cost); pick='gold'; updateStats();
    }

    // World regen & shortcuts
    document.getElementById('regen').onclick=()=>{ genWorld(0); };
    window.addEventListener('keydown', e=>{ if(e.key.toLowerCase()==='r') genWorld(0); });

    // Minimal music using WebAudio (beep arpeggio)
    let musicOn=false; let ctxAudio; let seqInt;
    document.getElementById('music').onclick=()=>{
      if(!musicOn){ startMusic(); this.textContent='T·∫Øt nh·∫°c ‚úñ'; } else { stopMusic(); }
    }
    function startMusic(){
      ctxAudio = new (window.AudioContext||window.webkitAudioContext)();
      const notes=[220,247,262,294,330,349,392,440].map(n=>n* (Math.random()<.5?1:2) );
      let i=0; seqInt = setInterval(()=>{
        const o=ctxAudio.createOscillator(); const g=ctxAudio.createGain();
        o.type='triangle'; o.frequency.value=notes[i%notes.length]; i++;
        g.gain.value=.0001; g.gain.linearRampToValueAtTime(.04, ctxAudio.currentTime+.02);
        g.gain.exponentialRampToValueAtTime(.0001, ctxAudio.currentTime+.28);
        o.connect(g).connect(ctxAudio.destination); o.start(); o.stop(ctxAudio.currentTime+.3);
      }, 350);
      musicOn=true; document.getElementById('music').textContent='T·∫Øt nh·∫°c ‚úñ';
    }
    function stopMusic(){ if(seqInt) clearInterval(seqInt); if(ctxAudio) ctxAudio.close(); musicOn=false; document.getElementById('music').textContent='B·∫≠t nh·∫°c ‚ô™'; }

    // Boot
    genWorld(0); requestAnimationFrame(loop);
  </script>
</body>
</html>
